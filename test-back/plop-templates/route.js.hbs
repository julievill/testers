import express from "express";
import { db } from "../index.js"; // Importa la conexiÃ³n a la base de datos desde index.js

const router = express.Router();

router.get("/", (req, res) => {
db.query("SELECT * FROM {{tableName}}", (err, results) => {
if (err) return res.status(500).json({ error: err.message });
res.json(results);
});
});

router.post("/", (req, res) => {
const data = req.body;
db.query("INSERT INTO {{tableName}} SET ?", data, (err, result) => {
if (err) return res.status(500).json({ error: err.message });
res.json({ message: "Registro creado", id: result.insertId });
});
});

router.put("/:id", (req, res) => {
const { id } = req.params;
const data = req.body;
db.query("UPDATE {{tableName}} SET ? WHERE id = ?", [data, id], (err, result) => {
if (err) return res.status(500).json({ error: err.message });
res.json({ message: "Registro actualizado" });
});
});

router.delete("/:id", (req, res) => {
const { id } = req.params;
db.query("DELETE FROM {{tableName}} WHERE id = ?", [id], (err, result) => {
if (err) return res.status(500).json({ error: err.message });
res.json({ message: "Registro eliminado" });
});
});

export default router;